<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>‚òï Coffee Clicker ‚òï</title>
    <style>
        /* Reset and Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #2b2b2b;
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            color: #4CAF50;
            margin-bottom: 20px;
            font-size: 2.5em;
            text-align: center;
        }

        /* Tab Navigation */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            width: 100%;
            max-width: 800px;
        }

        .tab {
            background-color: #3e3e3e;
            border: 2px solid #4CAF50;
            border-radius: 10px 10px 0 0;
            padding: 10px 20px;
            margin: 0 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 1em;
            flex: 1;
            text-align: center;
        }

        .tab.active {
            background-color: #4CAF50;
        }

        /* Tab Content */
        .tab-content {
            width: 100%;
            max-width: 800px;
            background-color: #3e3e3e;
            border: 2px solid #4CAF50;
            border-radius: 0 10px 10px 10px;
            padding: 20px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Stats Section */
        .stats p {
            margin: 10px 0;
            font-size: 1.2em;
        }

        /* Upgrades and Machines Sections */
        .section {
            margin: 20px 0;
        }

        .upgrade, .machine {
            background-color: #2e2e2e;
            padding: 15px;
            margin: 15px auto;
            border: 2px solid #4CAF50;
            border-radius: 10px;
            width: 100%;
            max-width: 350px;
            text-align: left;
            position: relative;
            transition: transform 0.1s;
        }

        .upgrade:hover, .machine:hover {
            transform: scale(1.02);
        }

        .upgrade h3, .machine h3 {
            margin-bottom: 10px;
            font-size: 1.3em;
            color: #FFD700;
        }

        .upgrade p, .machine p {
            margin: 5px 0;
            font-size: 1em;
        }

        .upgrade button, .machine button {
            width: 100%;
            padding: 10px;
            font-size: 1em;
            margin-top: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            background-color: #4CAF50;
            color: #fff;
        }

        .upgrade button:hover, .machine button:hover {
            background-color: #45a049;
        }

        /* Disabled Button Styles */
        button:disabled {
            background-color: #555;
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* Button Click Animation */
        .button-click {
            transform: scale(0.95);
        }

        /* Coffee Click Button */
        #coffee-button {
            background-color: #D2691E;
            color: #fff;
            font-size: 1.5em;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        #coffee-button:hover {
            background-color: #CD853F;
        }

        #coffee-button:active {
            transform: scale(0.95);
        }

        /* Particle Effect Styles */
        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            pointer-events: none;
            animation: particle-animation 0.6s forwards;
        }

        @keyframes particle-animation {
            from {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            to {
                transform: translate(100px, -100px) scale(0);
                opacity: 0;
            }
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(0,0,0,0.8);
            color: #fff;
            padding: 15px 25px;
            border-radius: 10px;
            display: none;
            z-index: 1000;
            font-size: 1em;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .notification.show {
            display: block;
            opacity: 1;
        }

        /* Footer Styles */
        footer {
            margin-top: 30px;
            font-size: 0.9em;
            text-align: center;
        }

        footer a {
            color: #4CAF50;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
                align-items: center;
            }

            .tab {
                margin: 5px 0;
                width: 80%;
            }

            .upgrade, .machine {
                width: 90%;
            }

            #coffee-button {
                width: 90%;
            }

            .stats p {
                font-size: 1em;
            }

            .upgrade h3, .machine h3 {
                font-size: 1.1em;
            }

            .upgrade p, .machine p {
                font-size: 0.9em;
            }
        }

        /* Machines Container */
        .machines-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        .machine {
            flex: 1 1 calc(50% - 40px);
            max-width: calc(50% - 40px);
        }

        @media (max-width: 600px) {
            .machine {
                flex: 1 1 100%;
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <h1>‚òï Coffee Clicker ‚òï</h1>

    <!-- Tab Navigation -->
    <div class="tabs">
        <div class="tab active" data-tab="stats">üìä Stats</div>
        <div class="tab" data-tab="upgrades">üîß Upgrades</div>
        <div class="tab" data-tab="machines">üõ†Ô∏è Machines</div>
    </div>

    <!-- Tab Contents -->
    <div id="stats" class="tab-content active">
        <div class="stats">
            <p>üë• <strong>Coffee:</strong> <span id="coffee-count">0</span></p>
            <p>‚ú® <strong>Coffee per Click (CPC):</strong> <span id="cpc">1</span></p>
            <p>‚è±Ô∏è <strong>Coffee per Second (CPS):</strong> <span id="cps">0</span></p>
            <p>üí´ <strong>Sparkle Chance:</strong> <span id="sparkleChance">0</span>%</p>
        </div>
    </div>

    <div id="upgrades" class="tab-content">
        <div class="section">
            <div class="upgrade" id="upgrade-cpc">
                <h3>‚ú® Increase CPC</h3>
                <p><strong>Effect:</strong> Increase Coffee per Click by 1.</p>
                <p><strong>Cost:</strong> <span id="cpc-cost">5</span> Coffee</p>
                <button id="upgrade-cpc-btn">Upgrade CPC</button>
            </div>
            <div class="upgrade" id="upgrade-sparkle">
                <h3>üí´ Increase Sparkle Chance</h3>
                <p><strong>Effect:</strong> Chance to earn double coffee per click.</p>
                <p><strong>Current Sparkle Chance:</strong> <span id="current-sparkle">0</span>%</p>
                <p><strong>Cost:</strong> <span id="sparkle-cost">1000</span> Coffee</p>
                <button id="upgrade-sparkle-btn">Upgrade Sparkle Chance</button>
            </div>
        </div>
    </div>

    <div id="machines" class="tab-content">
        <div class="section">
            <div class="machines-container">
                <div class="machine" id="machine1">
                    <h3>üõ†Ô∏è Coffee Beans</h3>
                    <p><strong>Level:</strong> <span id="machine1-level">0</span></p>
                    <p><strong>Effect:</strong> Grants +1 CPS</p>
                    <p><strong>Cost:</strong> <span id="machine1-cost">10</span> Coffee</p>
                    <button id="machine1-btn">Upgrade Coffee Beans</button>
                </div>
                <div class="machine" id="machine2">
                    <h3>üìÑ Coffee Filters</h3>
                    <p><strong>Level:</strong> <span id="machine2-level">0</span></p>
                    <p><strong>Effect:</strong> Grants +1 CPS</p>
                    <p><strong>Cost:</strong> <span id="machine2-cost">25</span> Coffee</p>
                    <button id="machine2-btn">Upgrade Coffee Filters</button>
                </div>
                <div class="machine" id="machine3">
                    <h3>üå∏ Coffee Cups</h3>
                    <p><strong>Level:</strong> <span id="machine3-level">0</span></p>
                    <p><strong>Effect:</strong> Grants +1 CPS</p>
                    <p><strong>Cost:</strong> <span id="machine3-cost">50</span> Coffee</p>
                    <button id="machine3-btn">Upgrade Coffee Cups</button>
                </div>
                <div class="machine" id="machine4">
                    <h3>üßÇ Coffee Creamer</h3>
                    <p><strong>Level:</strong> <span id="machine4-level">0</span></p>
                    <p><strong>Effect:</strong> Grants +1 CPS</p>
                    <p><strong>Cost:</strong> <span id="machine4-cost">100</span> Coffee</p>
                    <button id="machine4-btn">Upgrade Coffee Creamer</button>
                </div>
                <div class="machine" id="machine5">
                    <h3>üî• Coffee Heater</h3>
                    <p><strong>Level:</strong> <span id="machine5-level">0</span></p>
                    <p><strong>Effect:</strong> Grants +1 CPS</p>
                    <p><strong>Cost:</strong> <span id="machine5-cost">250</span> Coffee</p>
                    <button id="machine5-btn">Upgrade Coffee Heater</button>
                </div>
                <!-- Add more machines here if needed -->
            </div>
        </div>
    </div>

    <!-- Coffee Click Button -->
    <button id="coffee-button">‚òï Click Me!</button>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- Footer with Links -->
    <footer>
        <p>Join our Discord: <a href="https://discord.gg/aNThCfAPXG" target="_blank">üîó Discord Server</a></p>
        <p>Made by <strong>MouseManYT</strong> implemented by <a href="https://sites.google.com/view/staticquasar931" target="_blank"><strong>Static</strong></a></p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Game Variables
            let coffee = 0;
            let cpc = 1;
            let cps = 0;
            let sparkleChance = 0;

            let machine1 = 0;
            let machine2 = 0;
            let machine3 = 0;
            let machine4 = 0;
            let machine5 = 0;

            // Cost Variables
            let cpcCost = 5;
            let sparkleCost = 1000;

            let machine1Cost = 10;
            let machine2Cost = 25;
            let machine3Cost = 50;
            let machine4Cost = 100;
            let machine5Cost = 250;

            // DOM Elements
            const coffeeCountElem = document.getElementById('coffee-count');
            const cpcElem = document.getElementById('cpc');
            const cpsElem = document.getElementById('cps');
            const sparkleChanceElem = document.getElementById('sparkleChance');
            const currentSparkleElem = document.getElementById('current-sparkle');

            const upgradeCpcBtn = document.getElementById('upgrade-cpc-btn');
            const upgradeSparkleBtn = document.getElementById('upgrade-sparkle-btn');

            const machine1Btn = document.getElementById('machine1-btn');
            const machine2Btn = document.getElementById('machine2-btn');
            const machine3Btn = document.getElementById('machine3-btn');
            const machine4Btn = document.getElementById('machine4-btn');
            const machine5Btn = document.getElementById('machine5-btn');

            const coffeeButton = document.getElementById('coffee-button');

            const notification = document.getElementById('notification');

            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');

            // Initialize Game
            loadGame();
            updateDisplay();
            startAutoSave();

            // Load Game Data from localStorage with Validation
            function loadGame() {
                try {
                    coffee = parseInt(localStorage.getItem('coffee')) || 0;
                    cpc = parseInt(localStorage.getItem('cpc')) || 1;
                    cps = parseInt(localStorage.getItem('cps')) || 0;
                    sparkleChance = parseInt(localStorage.getItem('sparkleChance')) || 0;

                    machine1 = parseInt(localStorage.getItem('machine1')) || 0;
                    machine2 = parseInt(localStorage.getItem('machine2')) || 0;
                    machine3 = parseInt(localStorage.getItem('machine3')) || 0;
                    machine4 = parseInt(localStorage.getItem('machine4')) || 0;
                    machine5 = parseInt(localStorage.getItem('machine5')) || 0;

                    cpcCost = parseInt(localStorage.getItem('cpcCost')) || 5;
                    sparkleCost = parseInt(localStorage.getItem('sparkleCost')) || 1000;

                    machine1Cost = parseInt(localStorage.getItem('machine1Cost')) || 10;
                    machine2Cost = parseInt(localStorage.getItem('machine2Cost')) || 25;
                    machine3Cost = parseInt(localStorage.getItem('machine3Cost')) || 50;
                    machine4Cost = parseInt(localStorage.getItem('machine4Cost')) || 100;
                    machine5Cost = parseInt(localStorage.getItem('machine5Cost')) || 250;
                } catch (e) {
                    console.warn('LocalStorage is not accessible. Game progress will not be saved.', e);
                    showNotification('‚ö†Ô∏è LocalStorage not accessible. Progress will not be saved.');
                }
            }

            // Save Game Data to localStorage
            function saveGame() {
                if (isLocalStorageAvailable()) {
                    try {
                        localStorage.setItem('coffee', coffee);
                        localStorage.setItem('cpc', cpc);
                        localStorage.setItem('cps', cps);
                        localStorage.setItem('sparkleChance', sparkleChance);

                        localStorage.setItem('machine1', machine1);
                        localStorage.setItem('machine2', machine2);
                        localStorage.setItem('machine3', machine3);
                        localStorage.setItem('machine4', machine4);
                        localStorage.setItem('machine5', machine5);

                        localStorage.setItem('cpcCost', cpcCost);
                        localStorage.setItem('sparkleCost', sparkleCost);

                        localStorage.setItem('machine1Cost', machine1Cost);
                        localStorage.setItem('machine2Cost', machine2Cost);
                        localStorage.setItem('machine3Cost', machine3Cost);
                        localStorage.setItem('machine4Cost', machine4Cost);
                        localStorage.setItem('machine5Cost', machine5Cost);
                    } catch (e) {
                        console.warn('Failed to save to LocalStorage.', e);
                        showNotification('‚ö†Ô∏è Failed to save progress.');
                    }
                } else {
                    // Optionally, implement a fallback (e.g., in-memory storage)
                }
            }

            // Check if localStorage is available
            function isLocalStorageAvailable() {
                try {
                    const test = '__storage_test__';
                    localStorage.setItem(test, test);
                    localStorage.removeItem(test);
                    return true;
                } catch (e) {
                    return false;
                }
            }

            // Update Display Function
            function updateDisplay() {
                coffeeCountElem.innerText = coffee;
                cpcElem.innerText = cpc;
                cpsElem.innerText = cps;
                sparkleChanceElem.innerText = sparkleChance;

                // Update Upgrade Costs
                document.getElementById('cpc-cost').innerText = cpcCost;
                document.getElementById('sparkle-cost').innerText = sparkleCost;

                // Update Machine Levels and Costs
                document.getElementById('machine1-level').innerText = machine1;
                document.getElementById('machine1-cost').innerText = machine1Cost;
                document.getElementById('machine2-level').innerText = machine2;
                document.getElementById('machine2-cost').innerText = machine2Cost;
                document.getElementById('machine3-level').innerText = machine3;
                document.getElementById('machine3-cost').innerText = machine3Cost;
                document.getElementById('machine4-level').innerText = machine4;
                document.getElementById('machine4-cost').innerText = machine4Cost;
                document.getElementById('machine5-level').innerText = machine5;
                document.getElementById('machine5-cost').innerText = machine5Cost;

                // Disable buttons if maxed out
                checkMaxedOut();
            }

            // Show Notification
            function showNotification(message) {
                notification.innerText = message;
                notification.classList.add('show');
                clearTimeout(notification.timeout);
                notification.timeout = setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }

            // Coffee Button Click
            coffeeButton.addEventListener('click', (e) => {
                const rect = coffeeButton.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                createParticle(x, y);

                const chance = Math.random() * 100;
                if (chance < sparkleChance) {
                    coffee += cpc * 2;
                    showNotification('‚ú® SPARKLING COFFEE CLICK! Double Coffee Earned!');
                } else {
                    coffee += cpc;
                }
                animateButton(coffeeButton);
                updateDisplay();
                saveGame();
            });

            // Upgrade CPC
            upgradeCpcBtn.addEventListener('click', () => {
                if (coffee >= cpcCost) {
                    coffee -= cpcCost;
                    cpc += 1;
                    cpcCost = Math.round(cpcCost * 1.06); // Cost multiplier
                    animateButton(upgradeCpcBtn);
                    updateDisplay();
                    showNotification('‚ú® Coffee per Click Upgraded!');
                    saveGame();
                } else {
                    showNotification("‚ùå Not enough coffee for CPC upgrade!");
                }
            });

            // Upgrade Sparkle Chance
            upgradeSparkleBtn.addEventListener('click', () => {
                if (coffee >= sparkleCost) {
                    if (sparkleChance < 100) {
                        coffee -= sparkleCost;
                        sparkleChance += 1;
                        sparkleChance = Math.min(sparkleChance, 100); // Cap at 100%
                        sparkleCost = Math.round(sparkleCost * 1.15); // Cost multiplier
                        animateButton(upgradeSparkleBtn);
                        updateDisplay();
                        showNotification('üí´ Sparkle Chance Increased!');
                        saveGame();
                    } else {
                        showNotification("‚ú® Sparkle Chance is already at maximum!");
                    }
                } else {
                    showNotification("‚ùå Not enough coffee for Sparkle Chance upgrade!");
                }
            });

            // Machine1 Upgrade (Coffee Beans)
            machine1Btn.addEventListener('click', () => {
                if (coffee >= machine1Cost) {
                    coffee -= machine1Cost;
                    machine1 += 1;
                    cps += 1;
                    machine1Cost = Math.round(machine1Cost * 1.1); // Cost multiplier
                    animateButton(machine1Btn);
                    updateDisplay();
                    showNotification('üõ†Ô∏è Coffee Beans Machine Upgraded!');
                    saveGame();
                } else {
                    showNotification("‚ùå Not enough coffee for Coffee Beans upgrade!");
                }
            });

            // Machine2 Upgrade (Coffee Filters)
            machine2Btn.addEventListener('click', () => {
                if (coffee >= machine2Cost) {
                    coffee -= machine2Cost;
                    machine2 += 1;
                    cps += 1;
                    machine2Cost = Math.round(machine2Cost * 1.1); // Cost multiplier
                    animateButton(machine2Btn);
                    updateDisplay();
                    showNotification('üìÑ Coffee Filters Machine Upgraded!');
                    saveGame();
                } else {
                    showNotification("‚ùå Not enough coffee for Coffee Filters upgrade!");
                }
            });

            // Machine3 Upgrade (Coffee Cups)
            machine3Btn.addEventListener('click', () => {
                if (coffee >= machine3Cost) {
                    coffee -= machine3Cost;
                    machine3 += 1;
                    cps += 1;
                    machine3Cost = Math.round(machine3Cost * 1.1); // Cost multiplier
                    animateButton(machine3Btn);
                    updateDisplay();
                    showNotification('üå∏ Coffee Cups Machine Upgraded!');
                    saveGame();
                } else {
                    showNotification("‚ùå Not enough coffee for Coffee Cups upgrade!");
                }
            });

            // Machine4 Upgrade (Coffee Creamer)
            machine4Btn.addEventListener('click', () => {
                if (coffee >= machine4Cost) {
                    coffee -= machine4Cost;
                    machine4 += 1;
                    cps += 1;
                    machine4Cost = Math.round(machine4Cost * 1.1); // Cost multiplier
                    animateButton(machine4Btn);
                    updateDisplay();
                    showNotification('üßÇ Coffee Creamer Machine Upgraded!');
                    saveGame();
                } else {
                    showNotification("‚ùå Not enough coffee for Coffee Creamer upgrade!");
                }
            });

            // Machine5 Upgrade (Coffee Heater)
            machine5Btn.addEventListener('click', () => {
                if (coffee >= machine5Cost) {
                    coffee -= machine5Cost;
                    machine5 += 1;
                    cps += 1;
                    machine5Cost = Math.round(machine5Cost * 1.1); // Cost multiplier
                    animateButton(machine5Btn);
                    updateDisplay();
                    showNotification('üî• Coffee Heater Machine Upgraded!');
                    saveGame();
                } else {
                    showNotification("‚ùå Not enough coffee for Coffee Heater upgrade!");
                }
            });

            // Periodic Coffee Addition based on CPS (Every 3 seconds)
            setInterval(() => {
                coffee += 3 * cps;
                updateDisplay();
                saveGame();
            }, 3000); // Every 3 seconds

            // Auto-Save Functionality (Every 10 seconds)
            function startAutoSave() {
                setInterval(() => {
                    saveGame();
                }, 10000); // Every 10 seconds
            }

            // Tab Navigation
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    const target = tab.getAttribute('data-tab');
                    tabContents.forEach(content => {
                        if(content.id === target) {
                            content.classList.add('active');
                        } else {
                            content.classList.remove('active');
                        }
                    });
                });
            });

            // Function to Check Maxed Out Upgrades (Removed since no limits)
            function checkMaxedOut() {
                // Sparkle Chance Max
                if (sparkleChance >= 100) {
                    upgradeSparkleBtn.disabled = true;
                    document.querySelector('#upgrade-sparkle p:nth-child(4)').innerText = "Maxed Out!";
                } else {
                    upgradeSparkleBtn.disabled = false;
                    document.querySelector('#upgrade-sparkle p:nth-child(4)').innerText = `${sparkleCost} Coffee`;
                }

                // Machines do not have max levels now, so no need to disable buttons
                // However, to reflect updated costs, we ensure display is correct
                updateMachineCosts();
            }

            // Update Machine Costs Display
            function updateMachineCosts() {
                document.querySelectorAll('.machine').forEach(machine => {
                    const machineId = machine.id;
                    const costElem = machine.querySelector('p:nth-child(3)');
                    const cost = getMachineCost(machineId);
                    costElem.innerText = `Cost: ${cost} Coffee`;
                });
            }

            // Get Machine Cost based on ID
            function getMachineCost(machineId) {
                switch(machineId) {
                    case 'machine1':
                        return machine1Cost;
                    case 'machine2':
                        return machine2Cost;
                    case 'machine3':
                        return machine3Cost;
                    case 'machine4':
                        return machine4Cost;
                    case 'machine5':
                        return machine5Cost;
                    default:
                        return 0;
                }
            }

            // Animate Button Click
            function animateButton(button) {
                button.classList.add('button-click');
                setTimeout(() => {
                    button.classList.remove('button-click');
                }, 100);
            }

            // Create Particle Effect on Coffee Button Click
            function createParticle(x, y) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                coffeeButton.appendChild(particle);

                particle.addEventListener('animationend', () => {
                    particle.remove();
                });
            }
        </script>
</body>
</html>
